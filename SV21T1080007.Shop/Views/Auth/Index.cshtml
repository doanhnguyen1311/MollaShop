@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
	ViewBag.Title = "Đăng nhập / Đăng ký";
}

<nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
	<div class="container">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a href="~/Home">Trang chủ</a></li>
			<li class="breadcrumb-item active" aria-current="page">Login</li>
		</ol>
	</div><!-- End .container -->
</nav><!-- End .breadcrumb-nav -->

<div class="login-page bg-image pt-8 pb-8 pt-md-12 pb-md-12 pt-lg-17 pb-lg-17" style="background-image: url('assets/images/backgrounds/login-bg.jpg')">
	<div class="container">
		<div class="form-box">
			<div class="form-tab">
				<ul class="nav nav-pills nav-fill" role="tablist">
					<li class="nav-item">
						<a class="nav-link" id="signin-tab-2" data-toggle="tab" href="#signin-2" role="tab" aria-controls="signin-2" aria-selected="false">Đăng nhập</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" id="register-tab-2" data-toggle="tab" href="#register-2" role="tab" aria-controls="register-2" aria-selected="true">Đăng ký</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane fade" id="signin-2" role="tabpanel" aria-labelledby="signin-tab-2">
						<form action="">
							<div class="form-group">
								<label for="singin-email-2">Nhập email đăng nhập</label>
								<input type="text" class="form-control" id="singin-email-2" name="singin-email" required>
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="singin-password-2">Mật khẩu</label>
								<input type="password" class="form-control" id="singin-password-2" name="singin-password" required>
							</div><!-- End .form-group -->
                            <p id="info-login"></p>
							<div class="form-footer">
								<button type="submit" class="btn btn-outline-primary-2 btn-login">
									<span>ĐĂNG NHẬP</span>
									<i class="icon-long-arrow-right"></i>
								</button>

								<div class="custom-control custom-checkbox">
									<input type="checkbox" class="custom-control-input" id="signin-remember-2">
									<label class="custom-control-label" for="signin-remember-2">Remember Me</label>
								</div><!-- End .custom-checkbox -->

								<a href="#" class="forgot-link">Forgot Your Password?</a>
							</div><!-- End .form-footer -->
							
						</form>
						<div class="form-choice">
							<p class="text-center">or sign in with</p>
							<div class="row">
								<div class="col-sm-6">
									<a href="#" class="btn btn-login btn-g">
										<i class="icon-google"></i>
										Login With Google
									</a>
								</div><!-- End .col-6 -->
								<div class="col-sm-6">
									<a href="#" class="btn btn-login btn-f">
										<i class="icon-facebook-f"></i>
										Login With Facebook
									</a>
								</div><!-- End .col-6 -->
							</div><!-- End .row -->
						</div><!-- End .form-choice -->
					</div><!-- .End .tab-pane -->
					<div class="tab-pane fade show active" id="register-2" role="tabpanel" aria-labelledby="register-tab-2">
						<form action="#">
							<div class="form-group">
								<label for="register-email-2">Địa chỉ email của bạn *</label>
								<input type="email" class="form-control" id="register-email-2" name="register-email" required>
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="register-password-2">Mật khẩu *</label>
								<input type="password" class="form-control" id="register-password-2" name="register-password" required>
							</div><!-- End .form-group -->
							<div class="form-group">
								<label for="register-password-2">Nhập lại mật khẩu *</label>
								<input type="password" class="form-control" id="repeat-register-password-2" name="register-password" required>
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="register-customer-name">Họ và tên *</label>
								<input type="text" class="form-control" id="register-customer-name" name="register-customer-name" required>
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="register-contact-name">Tên hợp đồng</label>
								<input type="text" class="form-control" id="register-contact-name" name="register-contact-name">
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="register-province">Tỉnh/Thành phố *</label>
								<select class="form-control" id="register-province" name="register-province" required>
									<option value="" disabled selected>Chọn tỉnh/thành phố</option>
									@foreach (var item in SV21T1080007.BusinessLayers.CommonDataService.ListOfProvince())
									{
										<option value="@item.ProvinceName">@item.ProvinceName</option>
									}
								</select>
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="register-address">Địa chỉ *</label>
								<input type="text" class="form-control" id="register-address" name="register-address" required>
							</div><!-- End .form-group -->

							<div class="form-group">
								<label for="register-phone">Số điện thoại *</label>
								<input type="tel" class="form-control" id="register-phone" name="register-phone" required>
							</div><!-- End .form-group -->

							<p id="info-signup"></p>
							<div class="form-footer">
								<button type="submit" class="btn-register btn btn-outline-primary-2">
									<span>ĐĂNG KÝ</span>
									<i class="icon-long-arrow-right"></i>
								</button>

								<div class="custom-control custom-checkbox">
									<input type="checkbox" class="custom-control-input" id="register-policy-2" required>
									<label class="custom-control-label" for="register-policy-2">Tôi đồng ý với <a href="#">điều khoản sử dụng</a> *</label>
								</div><!-- End .custom-checkbox -->
							</div><!-- End .form-footer -->
						</form>
						<div class="form-choice">
							<p class="text-center">or sign in with</p>
							<div class="row">
								<div class="col-sm-6">
									<a href="#" class="btn btn-login btn-g">
										<i class="icon-google"></i>
										Login With Google
									</a>
								</div><!-- End .col-6 -->
								<div class="col-sm-6">
									<a href="#" class="btn btn-login  btn-f">
										<i class="icon-facebook-f"></i>
										Login With Facebook
									</a>
								</div><!-- End .col-6 -->
							</div><!-- End .row -->
						</div><!-- End .form-choice -->
					</div><!-- .End .tab-pane -->
				</div><!-- End .tab-content -->
			</div><!-- End .form-tab -->
		</div><!-- End .form-box -->
	</div><!-- End .container -->
</div><!-- End .login-page section-bg -->


<script>
	$(document).ready(function () {
		function Login(Username, Password){
			$.ajax({
				url: 'Auth/Login',
				method: 'GET',
				data: {
					username: Username, password: Password
				},
				success: function(res){
					if (res.success) {
						toastr.success(res.message);
						$("#info-login").html("Đăng nhập thành công! <a href=\"Home\">Về trang chủ</a>");
					}
					else{
						toastr.error(res.message);
					}
				},
				error: function(err){
					console.log(err);
				}
			});
		}

		$(document).on('click', '.btn-login', function (e) {
			e.preventDefault();
			let username = $('#singin-email-2').val();
			let password = $('#singin-password-2').val();
			Login(username, password);
		});

		function Register(CustomerName, Email, Password, Phone, Address, Province, RepeatPassword, ContactName) {
			$.ajax({
				url: 'Auth/Register',
				method: 'POST',
				data: {
					customerName: CustomerName,
					email: Email,
					password: Password,
					phone: Phone,
					address: Address,
					province: Province,
					repeatPassword: RepeatPassword,
					contactName: ContactName,
				},
				success: function (res) {
					if (res.success) {
						toastr.success(res.message);
					}
					else {
						toastr.error(res.message);
					}
				},
				error: function (err) {
					console.log(err);
				}
			});
		}

		$(document).on('click', '.btn-register', function (e) {
			e.preventDefault();
			let customerName = $('#register-customer-name').val();
			let email = $('#register-email-2').val();
			let password = $('#register-password-2').val();
			let phone = $('#register-phone').val();
			let address = $('#register-address').val();
			let province = $('#register-province').val();
			let Rpassword = $('#repeat-register-password-2').val();
			let contact = $("#register-contact-name").val();
			Register(customerName, email, password, phone, address, province, Rpassword, contact);
		});

	});
</script>